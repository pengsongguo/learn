<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div id="app">
      <msg-pop :show.sync="show">
        <!-- 具体名字插槽 -->
        <template v-slot:current>
          <h2>你好</h2>
        </template>
        <!-- 默认插槽 -->
        <template></template>
      </msg-pop>
      <h2>{{title}}</h2>
      <hr />
      <!-- 列表组件 -->
      <todo-list v-if="list.length>0" :list="list"></todo-list>

      <div v-else>任务列表为空</div>
      <br />

      <!-- 新增任务组件 -->
      <add-task v-model="current" @add-task-fn="add"></add-task>
      <button @click="clear">清空列表</button>
      <hr />
      <div>今日一共 {{total}} 个任务</div>
    </div>
  </body>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <script>
    // 消息弹出框
    Vue.component("msg-pop", {
      props: ["show"],
      template: `<div>
        最新任务：
        <slot name="current"></slot>
        <slot></slot>
      已经创建！！！
      <button @click="$emit('update:show',false)">X</button>
      </div>`,
    });
    // 列表组件
    Vue.component("todo-list", {
      props: {
        list: Array,
      },
      template: `<ul>
        <li v-for="(item,index) in list" :key="index">{{ item }}</li>
      </ul>`,
    });

    // 新增任务组件
    Vue.component("add-task", {
      props: ["value"],
      template: `<div>
        <input :value="value" @input="onInput" type="text" placeholder="请输入今日任务" />
      <button @click="add">添加</button></div>`,
      methods: {
        add() {
          this.$emit("add-task-fn", this.current);
        },
        onInput(e) {
          this.$emit("input", e.target.value);
        },
      },
    });

    // app组件
    const app = new Vue({
      el: "#app",
      data: {
        title: "任务列表",
        list: ["吃饭", "做饭", "打球"],
        current: "", //当前任务编辑,
        show: false,
      },
      methods: {
        add() {
          this.list.push(this.current);
          this, (current = "");
          this.show = true;
        },
        clear() {
          this.list = [];
        },
      },
      computed: {
        total() {
          return this.list.length;
        },
      },
    });
  </script>
</html>
